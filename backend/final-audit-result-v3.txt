node.exe : (node:26128) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} found. 
This is often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
En línea: 1 Carácter: 1
+ & "C:\Program Files\nodejs/node.exe" "C:\Program Files\nodejs/node_mo ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: ((node:26128) [M...dex definition.:String) [], Rem 
   oteException
    + FullyQualifiedErrorId : NativeCommandError
 
(Use `node --trace-warnings ...` to show where the warning was created)
(node:26128) [MONGOOSE] Warning: Duplicate schema index on {"numeroPedido":1} found. This is 
often due to declaring an index using both "index: true" and "schema.index()". Please remove 
the duplicate index definition.
(node:26128) [MONGOOSE] Warning: Duplicate schema index on {"expiraEn":1} found. This is often 
due to declaring an index using both "index: true" and "schema.index()". Please remove the 
duplicate index definition.
(node:26128) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} found. This is 
often due to declaring an index using both "index: true" and "schema.index()". Please remove 
the duplicate index definition.
[0mPOST /api/public/barberias/barberia-test/resenas?reviewToken=eb413929580220fd46b58e549cebeb85f7225873fe56f08d8213f1ca5605ec17 [32m201[0m 32.949 ms - 646[0m
[0mPOST /api/public/barberias/barberia-test/resenas [33m404[0m 3.272 ms - 51[0m
[0mPOST /api/public/barberias/barberia-test/resenas?reviewToken=invalid-token [33m404[0m 3.124 ms - 51[0m
[0mPOST /api/public/barberias/barberia-test/resenas?reviewToken=3042b242c66d701d4ebcc486cad404c4b54c4653e2e72d9f11a095069e8cf6f5 [32m201[0m 7.421 ms - 611[0m
[0mPOST /api/public/barberia-test/resenas?reviewToken=3042b242c66d701d4ebcc486cad404c4b54c4653e2e72d9f11a095069e8cf6f5 [33m404[0m 1.831 ms - 172[0m
[0mPOST /api/public/barberia-test/resenas?reviewToken=2d9c9064979a9ec56eda9a937e72b3bb02bdad416a194f83654678264bab08b2 [33m404[0m 0.518 ms - 172[0m
[0mGET /api/public/barberias/barberia-test/resenas/validar-token?reviewToken=e731f2bf665dd86a7fb2afae17abcc3f4f773b66d8517d1699aede529386a442 [32m200[0m 11.526 ms - 158[0m
[0mGET /api/public/barberias/barberia-test/resenas/validar-token?reviewToken=invalid [33m404[0m 2.914 ms - 60[0m
[0mGET /api/public/barberias/barberia-test/resenas [32m200[0m 12.694 ms - 864[0m
[0mGET /api/public/barberias/barberia-test/resenas [32m200[0m 6.553 ms - 864[0m
[0mGET /api/admin/resenas/pendientes [32m200[0m 6.667 ms - 424[0m
[0mGET /api/admin/resenas/pendientes [33m401[0m 0.206 ms - 27[0m
[0mPATCH /api/admin/resenas/698a960432fc42cf937c9d2e/aprobar [32m200[0m 8.803 ms - 448[0m
[0mPATCH /api/admin/resenas/698a960432fc42cf937c9d42/aprobar [33m401[0m 0.326 ms - 27[0m
[0mGET /api/admin/resenas/estadisticas [32m200[0m 2.958 ms - 141[0m
[0mGET /api/public/barberias/barberia-2/resenas [32m200[0m 6.330 ms - 474[0m
[0mGET /api/public/barberias/barberia-2/resenas [32m200[0m 7.617 ms - 474[0m
FAIL tests/resenas.test.js (7.653 s)
  ÔùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (13) from .env -- tip: ÔÜÖ´©Å  write to custom object with 
{ processEnv: myObject }

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      ƒôí [POST] /api/public/barberias/barberia-test/resenas?reviewToken=eb413929580220fd46b58e
549cebeb85f7225873fe56f08d8213f1ca5605ec17

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [POST] /api/public/barberias/barberia-test/resenas

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [POST] /api/public/barberias/barberia-test/resenas?reviewToken=invalid-token

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/barberia-test/resenas?reviewToken=3042b242c66d701d4ebcc4
86cad404c4b54c4653e2e72d9f11a095069e8cf6f5

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberia-test/resenas?reviewToken=3042b242c66d701d4ebcc486cad404c4
b54c4653e2e72d9f11a095069e8cf6f5

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberia-test/resenas?reviewToken=2d9c9064979a9ec56eda9a937e72b3bb
02bdad416a194f83654678264bab08b2

      at log (src/app.js:93:11)

    console.log
      ƒôí [GET] /api/public/barberias/barberia-test/resenas/validar-token?reviewToken=e731f2bf6
65dd86a7fb2afae17abcc3f4f773b66d8517d1699aede529386a442

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/public/barberias/barberia-test/resenas/validar-token?reviewToken=invalid

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/public/barberias/barberia-test/resenas

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/public/barberias/barberia-test/resenas

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/admin/resenas/pendientes

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/admin/resenas/pendientes

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [PATCH] /api/admin/resenas/698a960432fc42cf937c9d2e/aprobar

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [PATCH] /api/admin/resenas/698a960432fc42cf937c9d42/aprobar

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/admin/resenas/estadisticas

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/public/barberias/barberia-2/resenas

      at log (src/app.js:93:11)

    console.log
      ­ƒôí [GET] /api/public/barberias/barberia-2/resenas

      at log (src/app.js:93:11)

  ÔùÅ Sistema de Rese├▒as - Tests ÔÇ║ POST /api/public/:slug/resenas - Crear Rese├▒a ÔÇ║ Debe 
rechazar rese├▒a duplicada

    expect(received).toBe(expected) // Object.is equality

    Expected: 500
    Received: 404

    [0m [90m 157 |[39m                 })[33m;[39m
     [90m 158 |[39m
    [31m[1m>[22m[39m[90m 159 |[39m             
expect(response[33m.[39mstatus)[33m.[39mtoBe([35m500[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 160 |[39m             
expect(response[33m.[39mbody[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 161 |[39m         })[33m;[39m
     [90m 162 |[39m[0m

      at Object.toBe (tests/resenas.test.js:159:37)

  ÔùÅ Sistema de Rese├▒as - Tests ÔÇ║ POST /api/public/:slug/resenas - Crear Rese├▒a ÔÇ║ Debe 
rechazar rese├▒a sin calificaci├│n general

    expect(received).toBe(expected) // Object.is equality

    Expected: 500
    Received: 404

    [0m [90m 168 |[39m                 })[33m;[39m
     [90m 169 |[39m
    [31m[1m>[22m[39m[90m 170 |[39m             
expect(response[33m.[39mstatus)[33m.[39mtoBe([35m500[39m)[33m;[39m
     [90m     |[39m                                     [31m[1m^[22m[39m
     [90m 171 |[39m             
expect(response[33m.[39mbody[33m.[39msuccess)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m 172 |[39m         })[33m;[39m
     [90m 173 |[39m     })[33m;[39m[0m

      at Object.toBe (tests/resenas.test.js:170:37)

  ÔùÅ Sistema de Rese├▒as - Tests ÔÇ║ Multitenancy - Aislamiento de Datos ÔÇ║ Barber├¡a 1 solo 
debe ver sus propias rese├▒as

    expect(received).toBe(expected) // Object.is equality

    Expected: "698a960432fc42cf937c9d62"
    Received: "698a960432fc42cf937c9d6c"

    [0m [90m 422 |[39m             
expect(response[33m.[39mstatus)[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m 423 |[39m             expect(response[33m.[39mbody[33m.[39mdata[33m.[39mresen
as[33m.[39mlength)[33m.[39mtoBe([35m1[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 424 |[39m             expect(response[33m.[39mbody[33m.[39md
ata[33m.[39mresenas[[35m0[39m][33m.[39mbarberiaId[33m.[39mtoString())[33m.[39mtoBe(ba
rberia[33m.[39m_id[33m.[39mtoString())[33m;[39m
     [90m     |[39m                                                                         
[31m[1m^[22m[39m
     [90m 425 |[39m         })[33m;[39m
     [90m 426 |[39m
     [90m 427 |[39m         test([32m'Barber├¡a 2 solo debe ver sus propias 
rese├▒as'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.toBe (tests/resenas.test.js:424:73)

(node:26128) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} found. This is 
often due to declaring an index using both "index: true" and "schema.index()". Please remove 
the duplicate index definition.
(node:26128) [MONGOOSE] Warning: Duplicate schema index on {"numeroPedido":1} found. This is 
often due to declaring an index using both "index: true" and "schema.index()". Please remove 
the duplicate index definition.
(node:26128) [MONGOOSE] Warning: Duplicate schema index on {"expiraEn":1} found. This is often 
due to declaring an index using both "index: true" and "schema.index()". Please remove the 
duplicate index definition.
(node:26128) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} found. This is 
often due to declaring an index using both "index: true" and "schema.index()". Please remove 
the duplicate index definition.
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 84.579 ms - 604[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 99.688 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 333.430 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 328.387 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 340.692 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 332.445 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 340.609 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 340.536 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 344.331 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar [31m500[0m 337.523 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 1.561 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.462 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.378 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.359 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.358 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.334 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.329 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.337 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.391 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.343 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.528 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.389 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.364 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.354 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.355 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.337 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.372 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.333 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.327 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.458 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.611 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.391 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.358 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.619 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.320 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.323 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.322 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.317 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.308 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [33m429[0m 0.316 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 156.371 ms - 604[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 403.053 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 414.827 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 410.802 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 408.468 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 410.443 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 406.956 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 417.008 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 418.775 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 410.097 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 406.567 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 413.293 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 416.462 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 414.219 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 410.819 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 416.627 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 418.347 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 415.726 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 417.793 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar [31m500[0m 813.056 ms - 1173[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2e9e9/reservar [33m429[0m 0.399 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.442 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.363 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.369 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.390 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.337 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.329 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.373 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.352 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.303 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.298 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.361 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.341 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.314 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.302 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.318 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.312 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.343 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.356 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.387 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar [33m429[0m 0.352 ms - 61[0m
FAIL tests/race-condition-stress.test.js
  ÔùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (13) from .env -- tip: ƒæÑ sync secrets across teammates & 
machines: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9606635e4a44b8a2e83b/reservar

      at log (src/app.js:93:11)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Committed: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:61:25)

    console.error
      ­ƒö┤ ERROR: TypeError: this.emailService.sendReservaConfirmation is not a function
          at CreateReserva.sendReservaConfirmation [as execute] (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\application\use-cases\reservas\CreateReserva.js:80:31)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25)

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 1,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:20:54.861Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.081Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.083Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.090Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.091Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.091Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.095Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.095Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9606635e4a44b8a2e83b'), fecha: new Date(1773532800000), hora: "10:00", 
barberiaId: ObjectId('698a9606635e4a44b8a2e837') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), fecha: new 
Date(1773532800000), hora: "10:00", barberiaId: ObjectId('698a9606635e4a44b8a2e837') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9606635e4a44b8a2e83b'),
            fecha: 2026-03-15T00:00:00.000Z,
            hora: '10:00',
            barberiaId: new ObjectId('698a9606635e4a44b8a2e837')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.096Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9606635e4a44b8a2e83b'), 
fecha: new Date(1773532800000), hora: "10:00", barberiaId: 
ObjectId('698a9606635e4a44b8a2e837') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      Ô£à Exitosos: 0

      at Object.log (tests/race-condition-stress.test.js:84:21)

    console.log
      ÔØî Fallidos: 10

      at Object.log (tests/race-condition-stress.test.js:85:21)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9607635e4a44b8a2e8d3/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Committed: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:61:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ­ƒö┤ ERROR: TypeError: this.emailService.sendReservaConfirmation is not a function
          at CreateReserva.sendReservaConfirmation [as execute] (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\application\use-cases\reservas\CreateReserva.js:80:31)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25)

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 200ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 2/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.warn
      [Transaction] Transient error, retrying in 400ms: WriteConflict error: this operation 
conflicted with another operation. Please retry your operation or multi-document transaction.

    [0m [90m 74 |[39m                     attempt[33m++[39m[33m;[39m
     [90m 75 |[39m                     [36mconst[39m delay [33m=[39m retryDelay 
[33m*[39m [33mMath[39m[33m.[39mpow([35m2[39m[33m,[39m attempt)[33m;[39m [90m// 
Exponential backoff[39m
    [31m[1m>[22m[39m[90m 76 |[39m                     
console[33m.[39mwarn([32m`[Transaction] Transient error, retrying in 
${delay}ms:`[39m[33m,[39m error[33m.[39mmessage)[33m;[39m
     [90m    |[39m                             [31m[1m^[22m[39m
     [90m 77 |[39m                     [36mawait[39m 
[36mthis[39m[33m.[39msleep(delay)[33m;[39m
     [90m 78 |[39m                     [36mcontinue[39m[33m;[39m
     [90m 79 |[39m                 }[0m

      at Function.warn [as executeInTransaction] (src/utils/TransactionManager.js:76:29)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.612Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.617Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.618Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.619Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.619Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.620Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.621Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.622Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.623Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.624Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.635Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.638Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.642Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.643Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.644Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.645Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 2,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.648Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 2 },
        timestamp: 2026-02-10T02:20:55.649Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Started: CreateReservation (attempt 3/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
        attempt: 3,
        stack: `MongoServerError: E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: E11000 duplicate 
key error collection: test.reservas index: unique_reservation_slot dup key: { barberoId: 
ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new Date(1773619200000), hora: "14:00", 
barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applicati
on\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }
            at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongodb\src\operations\insert.ts:79:13)
            at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb
\src\operations\execute_operation.ts:294:26)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mon
godb\src\operations\execute_operation.ts:123:12)
            at Collection.insertOne 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongodb\src\collection.ts:294:12)
            at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
            at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
            at 
C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2722:9
            at async Promise.all (index 0)
            at Function.create 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:2707:11)
            at MongoReservaRepository.save (C:\Users\Kristian\Desktop\barber-saas\backend\src\i
nfrastructure\database\mongodb\repositories\MongoReservaRepository.js:15:16)
            at TransactionManager.executeInTransaction.operationName (C:\Users\Kristian\Desktop
\barber-saas\backend\src\application\use-cases\reservas\CreateReserva.js:72:42)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\applica
tion\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\controllers\public.controller.js:140:25) {
          errorLabelSet: Set(0) {},
          errorResponse: {
            index: 0,
            code: 11000,
            errmsg: `E11000 duplicate key error collection: test.reservas index: 
unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), fecha: new 
Date(1773619200000), hora: "14:00", barberiaId: ObjectId('698a9607635e4a44b8a2e8d1') }`,
            keyPattern: [Object],
            keyValue: [Object]
          },
          index: 0,
          code: 11000,
          keyPattern: { barberoId: 1, fecha: 1, hora: 1, barberiaId: 1 },
          keyValue: {
            barberoId: new ObjectId('698a9607635e4a44b8a2e8d3'),
            fecha: 2026-03-16T00:00:00.000Z,
            hora: '14:00',
            barberiaId: new ObjectId('698a9607635e4a44b8a2e8d1')
          }
        },
        context: { operationName: 'CreateReservation', attempt: 3 },
        timestamp: 2026-02-10T02:20:56.021Z,
        originalStack: `MongoServerError: E11000 duplicate key error collection: test.reservas 
index: unique_reservation_slot dup key: { barberoId: ObjectId('698a9607635e4a44b8a2e8d3'), 
fecha: new Date(1773619200000), hora: "14:00", barberiaId: 
ObjectId('698a9607635e4a44b8a2e8d1') }\n` +
          '    at InsertOneOperation.handleOk (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\node_modules\\mongodb\\src\\operations\\insert.ts:79:13)\n' +
          '    at tryOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_module
s\\mongodb\\src\\operations\\execute_operation.ts:294:26)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at executeOperation (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mo
dules\\mongodb\\src\\operations\\execute_operation.ts:123:12)\n' +
          '    at Collection.insertOne (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\nod
e_modules\\mongodb\\src\\collection.ts:294:12)\n' +
          '    at model.$__save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modul
es\\mongoose\\lib\\model.js:398:16)\n' +
          '    at model.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\
\mongoose\\lib\\model.js:609:5)\n' +
          '    at C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_modules\\mongoose\\l
ib\\model.js:2722:9\n' +
          '    at async Promise.all (index 0)\n' +
          '    at Function.create (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\node_mod
ules\\mongoose\\lib\\model.js:2707:11)\n' +
          '    at MongoReservaRepository.save (C:\\Users\\Kristian\\Desktop\\barber-saas\\backe
nd\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReservaRepository.js:15:16)\n' +
          '    at TransactionManager.executeInTransaction.operationName (C:\\Users\\Kristian\\D
esktop\\barber-saas\\backend\\src\\application\\use-cases\\reservas\\CreateReserva.js:72:42)\n'
 +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas\\bac
kend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\\sr
c\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desktop\\
barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m req[33m,[39m 
res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2e9e9/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2e9e9/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] /api/public/barberias/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar

      at log (src/app.js:93:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9608635e4a44b8a2ea09/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m metadata 
[33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

  ÔùÅ ƒöÑ Race Condition Stress Tests ÔÇ║ Concurrencia Extrema ÔÇ║ 10 requests simult├íneos al 
mismo horario - solo 1 debe tener ├®xito

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

    [0m [90m 86 |[39m
     [90m 87 |[39m             [90m// Solo 1 debe tener ├®xito[39m
    [31m[1m>[22m[39m[90m 88 |[39m             
expect(successful[33m.[39mlength)[33m.[39mtoBe([35m1[39m)[33m;[39m
     [90m    |[39m                                       [31m[1m^[22m[39m
     [90m 89 |[39m             
expect(failed[33m.[39mlength)[33m.[39mtoBe([35m9[39m)[33m;[39m
     [90m 90 |[39m
     [90m 91 |[39m             [90m// Verificar en DB que solo hay 1 reserva[39m[0m

      at Object.toBe (tests/race-condition-stress.test.js:88:39)

  ÔùÅ ƒöÑ Race Condition Stress Tests ÔÇ║ Concurrencia Extrema ÔÇ║ 50 requests simult├íneos - 
solo 1 debe tener ├®xito

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

    [0m [90m 123 |[39m             )[33m;[39m
     [90m 124 |[39m
    [31m[1m>[22m[39m[90m 125 |[39m             
expect(successful[33m.[39mlength)[33m.[39mtoBe([35m1[39m)[33m;[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 126 |[39m
     [90m 127 |[39m             [90m// Verificar en DB[39m
     [90m 128 |[39m             [36mconst[39m count [33m=[39m [36mawait[39m 
[33mReserva[39m[33m.[39mcountDocuments({[0m

      at Object.toBe (tests/race-condition-stress.test.js:125:39)

  ÔùÅ ƒöÑ Race Condition Stress Tests ÔÇ║ Performance bajo carga ÔÇ║ Maneja 20 reservas 
diferentes simult├íneas sin problemas

    expect(received).toBeGreaterThan(expected)

    Expected: > 15
    Received:   0

    [0m [90m 253 |[39m
     [90m 254 |[39m             [90m// Todas deber├¡an tener ├®xito (diferentes 
horarios)[39m
    [31m[1m>[22m[39m[90m 255 |[39m             
expect(successful[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m15[39m)[33m;[39m [90m// 
Al menos 75% de ├®xito[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 256 |[39m
     [90m 257 |[39m             [90m// Verificar que no hay duplicados[39m
     [90m 258 |[39m             [36mconst[39m reservas [33m=[39m [36mawait[39m 
[33mReserva[39m[33m.[39mfind({[0m

      at Object.toBeGreaterThan (tests/race-condition-stress.test.js:255:39)

Test Suites: 2 failed, 2 total
Tests:       6 failed, 16 passed, 22 total
Snapshots:   0 total
Time:        13.087 s
Ran all test suites matching /tests\\resenas.test.js|tests\\race-condition-stress.test.js/i.
