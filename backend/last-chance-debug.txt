node.exe : (node:30048) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} 
found. This is often due to declaring an index using both "index: true" and 
"schema.index()". Please remove the duplicate index definition.
En línea: 1 Carácter: 1
+ & "C:\Program Files\nodejs/node.exe" "C:\Program Files\nodejs/node_mo ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: ((node:30048) [M...dex definition.:String) [] 
   , RemoteException
    + FullyQualifiedErrorId : NativeCommandError
 
(Use `node --trace-warnings ...` to show where the warning was created)
(node:30048) [MONGOOSE] Warning: Duplicate schema index on {"numeroPedido":1} found. This 
is often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
(node:30048) [MONGOOSE] Warning: Duplicate schema index on {"expiraEn":1} found. This is 
often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
(node:30048) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} found. This 
is often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
[0mPOST /api/public/barberia-test/resenas?reviewToken=9092bf374e0e2900e32efcfadf4b58455510e141a164e686f9536009910058f0 [32m201[0m 12.208 ms - 646[0m
[0mPOST /api/public/barberia-test/resenas [33m404[0m 2.691 ms - 51[0m
[0mPOST /api/public/barberia-test/resenas?reviewToken=invalid-token [33m404[0m 2.721 ms - 51[0m
[0mPOST /api/public/barberia-test/resenas?reviewToken=e959f88518b79bf0bfb8b15e631c63d6171d239f74c4b3e1de5cde2677cc1ad4 [32m201[0m 5.184 ms - 611[0m
[0mPOST /api/public/barberia-test/resenas?reviewToken=e959f88518b79bf0bfb8b15e631c63d6171d239f74c4b3e1de5cde2677cc1ad4 [31m500[0m 13.745 ms - 55[0m
[0mPOST /api/public/barberia-test/resenas?reviewToken=c81ef6fe70e13764f65af74dca98145adfce9c69e192c0dc866a8fcfa00edccd [31m500[0m 5.621 ms - 55[0m
[0mGET /api/public/barberia-test/resenas/validar-token?reviewToken=1618e39497e0ecca271eb69d665ce15db5c8a2bfc977e23f9ed7750963a723ef [32m200[0m 9.801 ms - 158[0m
[0mGET /api/public/barberia-test/resenas/validar-token?reviewToken=invalid [33m404[0m 2.693 ms - 45[0m
[0mGET /api/public/barberia-test/resenas [32m200[0m 7.338 ms - 864[0m
[0mGET /api/public/barberia-test/resenas [32m200[0m 6.734 ms - 864[0m
[0mGET /api/admin/resenas/pendientes [32m200[0m 6.723 ms - 424[0m
[0mGET /api/admin/resenas/pendientes [33m401[0m 0.307 ms - 27[0m
[0mPATCH /api/admin/resenas/698a94155539b022d35d1791/aprobar [32m200[0m 6.287 ms - 448[0m
[0mPATCH /api/admin/resenas/698a94155539b022d35d17a5/aprobar [33m401[0m 0.364 ms - 27[0m
[0mGET /api/admin/resenas/estadisticas [32m200[0m 6.204 ms - 141[0m
[0mGET /api/public/barberia-test/resenas [32m200[0m 5.181 ms - 477[0m
[0mGET /api/public/barberia-2/resenas [32m200[0m 5.298 ms - 474[0m
FAIL tests/resenas.test.js (5.476 s)
  ÔùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (13) from .env -- tip: ƒöä add secrets lifecycle 
management: https://dotenvx.com/ops

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      ƒôí [POST] /api/public/barberia-test/resenas?reviewToken=9092bf374e0e2900e32efcfadf4
b58455510e141a164e686f9536009910058f0

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [POST] /api/public/barberia-test/resenas

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [POST] /api/public/barberia-test/resenas?reviewToken=invalid-token

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] /api/public/barberia-test/resenas?reviewToken=e959f88518b79bf0bfb8b15e631
c63d6171d239f74c4b3e1de5cde2677cc1ad4

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] /api/public/barberia-test/resenas?reviewToken=e959f88518b79bf0bfb8b15e631
c63d6171d239f74c4b3e1de5cde2677cc1ad4

      at log (src/app.js:98:11)

    console.error
      Error al crear rese├▒a: MongoServerError: E11000 duplicate key error collection: 
barber-saas-test.resenas index: reservaId_1 dup key: { reservaId: 
ObjectId('698a94155539b022d35d16dd') }
          at InsertOneOperation.handleOk (C:\Users\Kristian\Desktop\barber-saas\backend\no
de_modules\mongodb\src\operations\insert.ts:79:13)
          at tryOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mong
odb\src\operations\execute_operation.ts:294:26)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at executeOperation (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\
mongodb\src\operations\execute_operation.ts:123:12)
          at Collection.insertOne (C:\Users\Kristian\Desktop\barber-saas\backend\node_modu
les\mongodb\src\collection.ts:294:12)
          at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:398:16)
          at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
          at Object.<anonymous>.exports.crearResena (C:\Users\Kristian\Desktop\barber-saas
\backend\src\controllers\resenas.controller.js:97:9) {
        errorLabelSet: Set(0) {},
        errorResponse: {
          index: 0,
          code: 11000,
          errmsg: "E11000 duplicate key error collection: barber-saas-test.resenas index: 
reservaId_1 dup key: { reservaId: ObjectId('698a94155539b022d35d16dd') }",
          keyPattern: { reservaId: 1 },
          keyValue: { reservaId: new ObjectId('698a94155539b022d35d16dd') }
        },
        index: 0,
        code: 11000,
        keyPattern: { reservaId: 1 },
        keyValue: { reservaId: new ObjectId('698a94155539b022d35d16dd') }
      }

    [0m [90m 107 |[39m         })[33m;[39m
     [90m 108 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 109 |[39m         console[33m.[39merror([32m"Error al 
crear rese├▒a:"[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 110 |[39m         res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ 
success[33m:[39m [36mfalse[39m[33m,[39m message[33m:[39m [32m"Error al crear la 
rese├▒a"[39m })[33m;[39m
     [90m 111 |[39m     }
     [90m 112 |[39m }[33m;[39m[0m

      at error (src/controllers/resenas.controller.js:109:17)

    console.log
      ƒôí [POST] /api/public/barberia-test/resenas?reviewToken=c81ef6fe70e13764f65af74dca9
8145adfce9c69e192c0dc866a8fcfa00edccd

      at log (src/app.js:98:11)

    console.error
      Error al crear rese├▒a: ValidationError: Resena validation failed: 
calificacionGeneral: Path `calificacionGeneral` is required.
          at model.Object.<anonymous>.Document.invalidate (C:\Users\Kristian\Desktop\barbe
r-saas\backend\node_modules\mongoose\lib\document.js:3370:32)
          at validatePath (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mong
oose\lib\document.js:3145:13)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at async Promise.all (index 5)
          at model.$__validate (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules
\mongoose\lib\document.js:3086:3)
          at model.validate (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mo
ngoose\lib\document.js:2663:5)
          at model.validateBeforeSave (C:\Users\Kristian\Desktop\barber-saas\backend\node_
modules\mongoose\lib\plugins\validateBeforeSave.js:34:7)
          at Kareem.execPre 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\kareem\index.js:65:24)
          at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:369:5)
          at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
          at Object.<anonymous>.exports.crearResena (C:\Users\Kristian\Desktop\barber-saas
\backend\src\controllers\resenas.controller.js:97:9) {
        errors: {
          calificacionGeneral: ValidatorError: Path `calificacionGeneral` is required.
              at SchemaNumber.doValidate (C:\Users\Kristian\Desktop\barber-saas\backend\no
de_modules\mongoose\lib\schemaType.js:1425:13)
              at validatePath (C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\
mongoose\lib\document.js:3137:24)
              at model.$__validate (C:\Users\Kristian\Desktop\barber-saas\backend\node_mod
ules\mongoose\lib\document.js:3083:21)
              at processTicksAndRejections (node:internal/process/task_queues:105:5)
              at model.validate (C:\Users\Kristian\Desktop\barber-saas\backend\node_module
s\mongoose\lib\document.js:2663:5)
              at model.validateBeforeSave (C:\Users\Kristian\Desktop\barber-saas\backend\n
ode_modules\mongoose\lib\plugins\validateBeforeSave.js:34:7)
              at Kareem.execPre 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\kareem\index.js:65:24)
              at model.$__save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:369:5)
              at model.save 
(C:\Users\Kristian\Desktop\barber-saas\backend\node_modules\mongoose\lib\model.js:609:5)
              at Object.<anonymous>.exports.crearResena (C:\Users\Kristian\Desktop\barber-
saas\backend\src\controllers\resenas.controller.js:97:9) {
            properties: [Object],
            kind: 'required',
            path: 'calificacionGeneral',
            value: undefined,
            reason: undefined,
            [Symbol(mongoose#validatorError)]: true
          }
        },
        _message: 'Resena validation failed'
      }

    [0m [90m 107 |[39m         })[33m;[39m
     [90m 108 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 109 |[39m         console[33m.[39merror([32m"Error al 
crear rese├▒a:"[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 110 |[39m         res[33m.[39mstatus([35m500[39m)[33m.[39mjson({ 
success[33m:[39m [36mfalse[39m[33m,[39m message[33m:[39m [32m"Error al crear la 
rese├▒a"[39m })[33m;[39m
     [90m 111 |[39m     }
     [90m 112 |[39m }[33m;[39m[0m

      at error (src/controllers/resenas.controller.js:109:17)

    console.log
      ƒôí [GET] /api/public/barberia-test/resenas/validar-token?reviewToken=1618e39497e0ec
ca271eb69d665ce15db5c8a2bfc977e23f9ed7750963a723ef

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/public/barberia-test/resenas/validar-token?reviewToken=invalid

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/public/barberia-test/resenas

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/public/barberia-test/resenas

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/admin/resenas/pendientes

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/admin/resenas/pendientes

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [PATCH] /api/admin/resenas/698a94155539b022d35d1791/aprobar

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [PATCH] /api/admin/resenas/698a94155539b022d35d17a5/aprobar

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/admin/resenas/estadisticas

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/public/barberia-test/resenas

      at log (src/app.js:98:11)

    console.log
      ­ƒôí [GET] /api/public/barberia-2/resenas

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å MongoDB desconectado

    [0m [90m 89 |[39m   
mongoose[33m.[39mconnection[33m.[39mon([32m'disconnected'[39m[33m,[39m () 
[33m=>[39m {
     [90m 90 |[39m     isConnected [33m=[39m [36mfalse[39m[33m;[39m
    [31m[1m>[22m[39m[90m 91 |[39m     console[33m.[39mwarn([32m'ÔÜá´©Å MongoDB 
desconectado'[39m)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 92 |[39m   })[33m;[39m
     [90m 93 |[39m
     [90m 94 |[39m   
mongoose[33m.[39mconnection[33m.[39mon([32m'error'[39m[33m,[39m (err) 
[33m=>[39m {[0m

      at NativeConnection.warn (src/config/db.js:91:13)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:149:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1319:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1268:12)
      at Object.<anonymous> (tests/resenas.test.js:28:9)

  ÔùÅ Sistema de Rese├▒as - Tests ÔÇ║ GET /api/public/:slug/resenas/validar-token - 
Validar Token ÔÇ║ Debe rechazar token inv├ílido

    expect(received).toBe(expected) // Object.is equality

    Expected: false
    Received: undefined

    [0m [90m 187 |[39m
     [90m 188 |[39m             
expect(response[33m.[39mstatus)[33m.[39mtoBe([35m404[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m             expect(response[33m.[39mbody[33m.
[39mvalido)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
     [90m     |[39m                                          [31m[1m^[22m[39m
     [90m 190 |[39m         })[33m;[39m
     [90m 191 |[39m     })[33m;[39m
     [90m 192 |[39m[0m

      at Object.toBe (tests/resenas.test.js:189:42)

(node:30048) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} found. This 
is often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
(node:30048) [MONGOOSE] Warning: Duplicate schema index on {"numeroPedido":1} found. This 
is often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
(node:30048) [MONGOOSE] Warning: Duplicate schema index on {"expiraEn":1} found. This is 
often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
(node:30048) [MONGOOSE] Warning: Duplicate schema index on {"reviewToken":1} found. This 
is often due to declaring an index using both "index: true" and "schema.index()". Please 
remove the duplicate index definition.
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 45.882 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 52.204 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 51.144 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 49.976 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 49.093 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 48.358 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 47.839 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 47.300 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 46.715 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar [31m500[0m 50.727 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 1.449 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.382 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.332 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.332 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.329 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.325 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.324 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.326 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.331 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.338 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.347 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 3.023 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.396 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.351 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.322 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.328 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.338 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.321 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.323 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.320 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.321 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.316 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.313 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.403 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.340 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.409 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.332 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.341 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.311 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [33m429[0m 0.329 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 109.737 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 108.829 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 108.142 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 107.499 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 106.855 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 106.309 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 105.705 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 105.046 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 101.664 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 100.795 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 112.781 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 114.085 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 113.822 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 113.382 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 112.929 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 112.468 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 111.982 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 111.481 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 110.933 ms - 791[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar [31m500[0m 110.394 ms - 791[0m
[0mPOST /api/public/test-barberia/barberos/698a9417611fdaaeec692bcb/reservar [33m404[0m 0.802 ms - 207[0m
FAIL tests/race-condition-stress.test.js
  ÔùÅ Console

    console.log
      [dotenv@17.2.3] injecting env (13) from .env -- tip: ƒöÉ prevent building .env in 
docker: https://dotenvx.com/prebuild

      at _log (node_modules/dotenv/lib/main.js:142:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b07/reservar

      at log (src/app.js:98:11)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.245Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.253Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.254Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.255Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.256Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.257Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.258Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.258Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.260Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.267Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      Ô£à Exitosos: 0

      at Object.log (tests/race-condition-stress.test.js:84:21)

    console.log
      ÔØî Fallidos: 10

      at Object.log (tests/race-condition-stress.test.js:85:21)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692b41/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692b41/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Started: CreateReservation (attempt 1/3)

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:54:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.430Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.432Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.433Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.433Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.434Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.435Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.436Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.437Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.437Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.438Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.log
      [Transaction] Aborted: CreateReservation

      at Function.log [as executeInTransaction] (src/utils/TransactionManager.js:69:29)

    console.error
      [Transaction] Failed: CreateReservation {
        error: 'barberiaId es requerido para el aislamiento de datos',
        attempt: 1,
        stack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 80 |[39m
     [90m 81 |[39m                 [90m// Non-transient error or max retries 
reached[39m
    [31m[1m>[22m[39m[90m 82 |[39m                 
console[33m.[39merror([32m`[Transaction] Failed: ${operationName}`[39m[33m,[39m {
     [90m    |[39m                         [31m[1m^[22m[39m
     [90m 83 |[39m                     error[33m:[39m 
error[33m.[39mmessage[33m,[39m
     [90m 84 |[39m                     attempt[33m:[39m attempt [33m+[39m 
[35m1[39m[33m,[39m
     [90m 85 |[39m                     stack[33m:[39m error[33m.[39mstack[0m

      at Function.error [as executeInTransaction] (src/utils/TransactionManager.js:82:25)
      at CreateReserva.execute (src/application/use-cases/reservas/CreateReserva.js:26:34)
      at Object.<anonymous>.exports.crearReservaBySlug 
(src/controllers/public.controller.js:140:25)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.445Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.446Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.447Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.448Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.448Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.449Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.450Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.451Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.451Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.error
      ƒö┤ ERROR: TransactionError: Transaction failed for CreateReservation: barberiaId 
es requerido para el aislamiento de datos
          at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:88:42)
          at processTicksAndRejections (node:internal/process/task_queues:105:5)
          at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:26:34)
          at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\controllers\public.controller.js:140:25) {
        isTransactionError: true,
        originalError: Error: barberiaId es requerido para el aislamiento de datos
            at MongoReservaRepository.findByBarberoAndDate (C:\Users\Kristian\Desktop\barb
er-saas\backend\src\infrastructure\database\mongodb\repositories\MongoReservaRepository.js
:38:19)
            at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\Users
\Kristian\Desktop\barber-saas\backend\src\domain\services\AvailabilityService.js:59:55)
            at isTimeSlotAvailable (C:\Users\Kristian\Desktop\barber-saas\backend\src\appl
ication\use-cases\reservas\CreateReserva.js:40:72)
            at processTicksAndRejections (node:internal/process/task_queues:105:5)
            at Function.executeInTransaction 
(C:\Users\Kristian\Desktop\barber-saas\backend\src\utils\TransactionManager.js:57:32)
            at CreateReserva.execute (C:\Users\Kristian\Desktop\barber-saas\backend\src\ap
plication\use-cases\reservas\CreateReserva.js:26:34)
            at Object.<anonymous>.exports.crearReservaBySlug (C:\Users\Kristian\Desktop\ba
rber-saas\backend\src\controllers\public.controller.js:140:25),
        context: { operationName: 'CreateReservation', attempt: 1 },
        timestamp: 2026-02-10T02:12:39.452Z,
        originalStack: 'Error: barberiaId es requerido para el aislamiento de datos\n' +
          '    at MongoReservaRepository.findByBarberoAndDate (C:\\Users\\Kristian\\Deskto
p\\barber-saas\\backend\\src\\infrastructure\\database\\mongodb\\repositories\\MongoReserv
aRepository.js:38:19)\n' +
          '    at AvailabilityService.findByBarberoAndDate [as isTimeSlotAvailable] (C:\\U
sers\\Kristian\\Desktop\\barber-saas\\backend\\src\\domain\\services\\AvailabilityService.
js:59:55)\n' +
          '    at isTimeSlotAvailable (C:\\Users\\Kristian\\Desktop\\barber-saas\\backend\
\src\\application\\use-cases\\reservas\\CreateReserva.js:40:72)\n' +
          '    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
          '    at Function.executeInTransaction (C:\\Users\\Kristian\\Desktop\\barber-saas
\\backend\\src\\utils\\TransactionManager.js:57:32)\n' +
          '    at CreateReserva.execute (C:\\Users\\Kristian\\Desktop\\barber-saas\\backen
d\\src\\application\\use-cases\\reservas\\CreateReserva.js:26:34)\n' +
          '    at Object.<anonymous>.exports.crearReservaBySlug (C:\\Users\\Kristian\\Desk
top\\barber-saas\\backend\\src\\controllers\\public.controller.js:140:25)'
      }

    [0m [90m 4 |[39m
     [90m 5 |[39m [36mconst[39m errorHandler [33m=[39m (err[33m,[39m 
req[33m,[39m res[33m,[39m next) [33m=>[39m {
    [31m[1m>[22m[39m[90m 6 |[39m   console[33m.[39merror([32m"ƒö┤ 
ERROR:"[39m[33m,[39m err)[33m;[39m
     [90m   |[39m           [31m[1m^[22m[39m
     [90m 7 |[39m
     [90m 8 |[39m   [90m// ­ƒöÑ A├æADIR HEADERS CORS SI NO EXISTEN[39m
     [90m 9 |[39m   [36mconst[39m origin [33m=[39m 
req[33m.[39mheaders[33m.[39morigin[33m;[39m[0m

      at error (src/config/middleware/errorHandler.js:6:11)
      at Layer.handleError (node_modules/router/lib/layer.js:116:17)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at next (node_modules/router/index.js:291:5)
      at Layer.handleError (node_modules/router/lib/layer.js:111:12)
      at trimPrefix (node_modules/router/index.js:340:13)
      at node_modules/router/index.js:297:9
      at processParams (node_modules/router/index.js:582:12)
      at Immediate.next (node_modules/router/index.js:291:5)
      at Immediate._onImmediate (node_modules/router/index.js:688:15)

    console.log
      ­ƒôí [POST] /api/public/test-barberia/barberos/698a9417611fdaaeec692bcb/reservar

      at log (src/app.js:98:11)

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.log
      ƒôí [POST] 
/api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar

      at log (src/app.js:98:11)

    console.warn
      ÔÜá´©Å  [Security] Rate limit exceeded {
        ip: '::ffff:127.0.0.1',
        method: 'POST',
        path: '/test-barberia/barberos/698a9417611fdaaeec692beb/reservar',
        max: 30
      }

    [0m [90m 38 |[39m [90m     */[39m
     [90m 39 |[39m     [36mstatic[39m warn(context[33m,[39m message[33m,[39m 
metadata [33m=[39m {}) {
    [31m[1m>[22m[39m[90m 40 |[39m         console[33m.[39mwarn([32m`ÔÜá´©Å  
[${context}] ${message}`[39m[33m,[39m metadata)[33m;[39m
     [90m    |[39m                 [31m[1m^[22m[39m
     [90m 41 |[39m     }
     [90m 42 |[39m
     [90m 43 |[39m     [90m/**[39m[0m

      at Function.warn (src/shared/Logger.js:40:17)
      at Object.warn [as handler] (src/middleware/rateLimit.middleware.js:18:20)
      at node_modules/express-rate-limit/dist/index.cjs:939:16
      at node_modules/express-rate-limit/dist/index.cjs:825:5

    console.warn
      ÔÜá´©Å MongoDB desconectado

    [0m [90m 89 |[39m   
mongoose[33m.[39mconnection[33m.[39mon([32m'disconnected'[39m[33m,[39m () 
[33m=>[39m {
     [90m 90 |[39m     isConnected [33m=[39m [36mfalse[39m[33m;[39m
    [31m[1m>[22m[39m[90m 91 |[39m     console[33m.[39mwarn([32m'ÔÜá´©Å MongoDB 
desconectado'[39m)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 92 |[39m   })[33m;[39m
     [90m 93 |[39m
     [90m 94 |[39m   
mongoose[33m.[39mconnection[33m.[39mon([32m'error'[39m[33m,[39m (err) 
[33m=>[39m {[0m

      at NativeConnection.warn (src/config/db.js:91:13)
      at NativeConnection.set (node_modules/mongoose/lib/connection.js:149:12)
      at NativeConnection.onClose (node_modules/mongoose/lib/connection.js:1319:19)
      at NativeConnection._close (node_modules/mongoose/lib/connection.js:1268:12)
      at closeDB (tests/setup.js:29:5)
      at Object.<anonymous> (tests/race-condition-stress.test.js:22:9)

  ÔùÅ ƒöÑ Race Condition Stress Tests ÔÇ║ Concurrencia Extrema ÔÇ║ 10 requests 
simult├íneos al mismo horario - solo 1 debe tener ├®xito

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

    [0m [90m 86 |[39m
     [90m 87 |[39m             [90m// Solo 1 debe tener ├®xito[39m
    [31m[1m>[22m[39m[90m 88 |[39m             
expect(successful[33m.[39mlength)[33m.[39mtoBe([35m1[39m)[33m;[39m
     [90m    |[39m                                       [31m[1m^[22m[39m
     [90m 89 |[39m             
expect(failed[33m.[39mlength)[33m.[39mtoBe([35m9[39m)[33m;[39m
     [90m 90 |[39m
     [90m 91 |[39m             [90m// Verificar en DB que solo hay 1 reserva[39m[0m

      at Object.toBe (tests/race-condition-stress.test.js:88:39)

  ÔùÅ ƒöÑ Race Condition Stress Tests ÔÇ║ Concurrencia Extrema ÔÇ║ 50 requests 
simult├íneos - solo 1 debe tener ├®xito

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 0

    [0m [90m 123 |[39m             )[33m;[39m
     [90m 124 |[39m
    [31m[1m>[22m[39m[90m 125 |[39m             
expect(successful[33m.[39mlength)[33m.[39mtoBe([35m1[39m)[33m;[39m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 126 |[39m
     [90m 127 |[39m             [90m// Verificar en DB[39m
     [90m 128 |[39m             [36mconst[39m count [33m=[39m [36mawait[39m 
[33mReserva[39m[33m.[39mcountDocuments({[0m

      at Object.toBe (tests/race-condition-stress.test.js:125:39)

  ÔùÅ ƒöÑ Race Condition Stress Tests ÔÇ║ Performance bajo carga ÔÇ║ Maneja 20 reservas 
diferentes simult├íneas sin problemas

    expect(received).toBeGreaterThan(expected)

    Expected: > 15
    Received:   0

    [0m [90m 253 |[39m
     [90m 254 |[39m             [90m// Todas deber├¡an tener ├®xito (diferentes 
horarios)[39m
    [31m[1m>[22m[39m[90m 255 |[39m             
expect(successful[33m.[39mlength)[33m.[39mtoBeGreaterThan([35m15[39m)[33m;[39m 
[90m// Al menos 75% de ├®xito[39m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.414 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.313 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.369 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.316 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.310 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.310 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.358 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.315 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.322 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.306 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.312 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.299 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.305 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.300 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.311 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.343 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.305 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.301 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.381 ms - 61[0m
[0mPOST /api/public/barberias/test-barberia/barberos/698a9417611fdaaeec692beb/reservar [33m429[0m 0.307 ms - 61[0m
     [90m     |[39m                                       [31m[1m^[22m[39m
     [90m 256 |[39m
     [90m 257 |[39m             [90m// Verificar que no hay duplicados[39m
     [90m 258 |[39m             [36mconst[39m reservas [33m=[39m [36mawait[39m 
[33mReserva[39m[33m.[39mfind({[0m

      at Object.toBeGreaterThan (tests/race-condition-stress.test.js:255:39)

Test Suites: 2 failed, 2 total
Tests:       4 failed, 18 passed, 22 total
Snapshots:   0 total
Time:        7.304 s
Ran all test suites matching 
/tests\\resenas.test.js|tests\\race-condition-stress.test.js/i.
